{"version":3,"file":"VizServiceImpl.js","sourceRoot":"","sources":["../../../../../src/ApiShared/Services/impl/VizServiceImpl.ts"],"names":[],"mappings":"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","sourcesContent":["import { CustomViewModel, ExecuteParameters, ParameterId, VerbId } from '@tableau/api-internal-contract-js';\nimport { CustomViewImpl } from '../../Impl/CustomViewImpl';\nimport { ServiceNames } from '../ServiceRegistry';\nimport { VizService } from '../VizService';\nimport { ServiceImplBase } from './ServiceImplBase';\n\nexport class VizServiceImpl extends ServiceImplBase implements VizService {\n  public get serviceName(): string {\n    return ServiceNames.Viz;\n  }\n\n  public createVizImageAsync(inputSpec: object): Promise<string> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'createVizImageAsync',\n      [ParameterId.VizAPIInputJson]: JSON.stringify(inputSpec),\n    };\n\n    return this.execute(VerbId.VizAPI, parameters).then((response) => {\n      const result = response.result as string;\n      return result;\n    });\n  }\n\n  public activateSheetAsync(name: string): Promise<void> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'activateSheetAsync',\n      [ParameterId.SwitchToSheetName]: name,\n    };\n\n    return this.execute(VerbId.ActivateSheet, parameters).then(() => {\n      return;\n    });\n  }\n\n  public getCustomViewsAsync(): Promise<Array<CustomViewImpl>> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'getCustomViewsAsync',\n    };\n\n    return this.execute(VerbId.GetCustomViews, parameters).then<Array<CustomViewImpl>>((response) => {\n      const customViews = response.result as Array<CustomViewModel>;\n      return customViews.map((customView: CustomViewModel) => {\n        return new CustomViewImpl(customView, this._registryId);\n      });\n    });\n  }\n\n  public showCustomViewAsync(customViewName?: string | null): Promise<CustomViewImpl | undefined> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'showCustomViewAsync',\n      [ParameterId.CustomViewName]: customViewName || '', // a falsey value means \"show original view\"\n    };\n\n    return this.execute(VerbId.ShowCustomView, parameters).then<CustomViewImpl | undefined>((response) => {\n      const customView = response.result as CustomViewModel;\n      return customView?.luid ? new CustomViewImpl(customView, this._registryId) : undefined;\n    });\n  }\n\n  public removeCustomViewAsync(customViewName: string): Promise<CustomViewImpl> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'removeCustomViewAsync',\n      [ParameterId.CustomViewName]: customViewName,\n    };\n\n    return this.execute(VerbId.RemoveCustomView, parameters).then<CustomViewImpl>((response) => {\n      const customView = response.result as CustomViewModel;\n      return new CustomViewImpl(customView, this._registryId);\n    });\n  }\n\n  public saveCustomViewAsync(customViewName: string): Promise<CustomViewImpl> {\n    // CustomViewIsDefault is a required parameter, but our API has not been updated to allow it to be specified yet.\n    // We should add a 'default' parameter to the interface.\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'saveCustomViewAsync',\n      [ParameterId.CustomViewName]: customViewName,\n      [ParameterId.CustomViewIsDefault]: false,\n    };\n\n    return this.execute(VerbId.SaveWorkbookAsCustomView, parameters).then<CustomViewImpl>((response) => {\n      const customView = response.result as CustomViewModel;\n      return new CustomViewImpl(customView, this._registryId);\n    });\n  }\n\n  public setActiveCustomViewAsDefaultAsync(): Promise<void> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'setActiveCustomViewAsDefaultAsync',\n    };\n\n    return this.execute(VerbId.SetActiveCustomViewAsDefault, parameters).then(() => {\n      return;\n    });\n  }\n\n  public saveAsync(customView: CustomViewImpl): Promise<CustomViewImpl> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'saveAsync',\n      [ParameterId.CustomViewLuid]: customView.luid,\n      [ParameterId.CustomViewName]: customView.name,\n      [ParameterId.CustomViewIsDefault]: customView.isDefault,\n      [ParameterId.CustomViewIsPublic]: customView.shared,\n    };\n\n    return this.execute(VerbId.UpdateCustomView, parameters).then<CustomViewImpl>((response) => {\n      const customView = response.result as CustomViewModel;\n      return new CustomViewImpl(customView, this._registryId);\n    });\n  }\n\n  public getCurrentSrcAsync(): Promise<string> {\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'getCurrentSrcAsync',\n    };\n\n    return this.execute(VerbId.GetCurrentSrc, parameters).then((response) => response.result as string);\n  }\n}\n"]}