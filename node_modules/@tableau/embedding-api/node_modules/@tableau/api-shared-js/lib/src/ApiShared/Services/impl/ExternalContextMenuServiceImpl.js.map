{"version":3,"file":"ExternalContextMenuServiceImpl.js","sourceRoot":"","sources":["../../../../../src/ApiShared/Services/impl/ExternalContextMenuServiceImpl.ts"],"names":[],"mappings":";;AACA,gFAA2F;AAG3F,uDAAoD;AAEpD,MAAa,8BAA+B,SAAQ,iCAAe;IACjE,IAAW,WAAW;QACpB,iEAAwC;IAC1C,CAAC;IAEM,sBAAsB,CAAC,SAAiB,EAAE,UAAuB,EAAE,MAA0B;QAClG,MAAM,IAAI,GAAG,iCAAM,CAAC,sBAAsB,CAAC;QAC3C,MAAM,UAAU,GAAsB;YACpC,CAAC,sCAAW,CAAC,YAAY,CAAC,EAAE,wBAAwB;YACpD,CAAC,sCAAW,CAAC,aAAa,CAAC,EAAE,SAAS;YACtC,CAAC,sCAAW,CAAC,2BAA2B,CAAC,EAAE,MAAM,CAAC,WAAW;SAC9D,CAAC;QAEF,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,IAAI,CAAS,CAAC,QAAQ,EAAE,EAAE;YAC9D,MAAM,aAAa,GAAG,QAAQ,CAAC,MAAgB,CAAC;YAChD,OAAO,aAAa,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,sBAAsB,CAAC,SAAiB,EAAE,UAAuB,EAAE,UAAkB;QAC1F,MAAM,IAAI,GAAG,iCAAM,CAAC,sBAAsB,CAAC;QAC3C,MAAM,UAAU,GAAsB;YACpC,CAAC,sCAAW,CAAC,YAAY,CAAC,EAAE,wBAAwB;YACpD,CAAC,sCAAW,CAAC,aAAa,CAAC,EAAE,SAAS;YACtC,CAAC,sCAAW,CAAC,kBAAkB,CAAC,EAAE,UAAU;SAC7C,CAAC;QAEF,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,IAAI,CAAO,CAAC,QAAQ,EAAE,EAAE;YAC5D,OAAO;QACT,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,uBAAuB,CAAC,SAAiB,EAAE,UAAuB,EAAE,UAAkB;QAC3F,MAAM,IAAI,GAAG,iCAAM,CAAC,uBAAuB,CAAC;QAC5C,MAAM,UAAU,GAAsB;YACpC,CAAC,sCAAW,CAAC,YAAY,CAAC,EAAE,yBAAyB;YACrD,CAAC,sCAAW,CAAC,aAAa,CAAC,EAAE,SAAS;YACtC,CAAC,sCAAW,CAAC,kBAAkB,CAAC,EAAE,UAAU;SAC7C,CAAC;QAEF,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,IAAI,CAAO,CAAC,QAAQ,EAAE,EAAE;YAC5D,OAAO;QACT,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,sBAAsB,CAAC,SAAiB,EAAE,UAAuB,EAAE,UAAkB,EAAE,eAAuB;QACnH,MAAM,IAAI,GAAG,iCAAM,CAAC,kBAAkB,CAAC;QACvC,MAAM,UAAU,GAAsB;YACpC,CAAC,sCAAW,CAAC,YAAY,CAAC,EAAE,wBAAwB;YACpD,CAAC,sCAAW,CAAC,aAAa,CAAC,EAAE,SAAS;YACtC,CAAC,sCAAW,CAAC,kBAAkB,CAAC,EAAE,UAAU;YAC5C,CAAC,sCAAW,CAAC,uBAAuB,CAAC,EAAE,eAAe;SACvD,CAAC;QAEF,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,IAAI,CAAO,CAAC,QAAQ,EAAE,EAAE;YAC5D,OAAO;QACT,CAAC,CAAC,CAAC;IACL,CAAC;CACF;AA1DD,wEA0DC","sourcesContent":["import { ApiMenuType, ContextMenuOptions } from '@tableau/api-external-contract-js';\nimport { ExecuteParameters, ParameterId, VerbId } from '@tableau/api-internal-contract-js';\nimport { ExternalContextMenuService } from '../ExternalContextMenuService';\nimport { ServiceNames } from '../ServiceRegistry';\nimport { ServiceImplBase } from './ServiceImplBase';\n\nexport class ExternalContextMenuServiceImpl extends ServiceImplBase implements ExternalContextMenuService {\n  public get serviceName(): string {\n    return ServiceNames.ExternalContextMenu;\n  }\n\n  public appendContextMenuAsync(sheetName: string, targetMenu: ApiMenuType, config: ContextMenuOptions): Promise<string> {\n    const verb = VerbId.AppendExternalMenuItem;\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'appendContextMenuAsync',\n      [ParameterId.WorksheetName]: sheetName,\n      [ParameterId.ExternalMenuItemDisplayName]: config.displayName,\n    };\n\n    return this.execute(verb, parameters).then<string>((response) => {\n      const newMenuItemId = response.result as string;\n      return newMenuItemId;\n    });\n  }\n\n  public removeContextMenuAsync(sheetName: string, targetMenu: ApiMenuType, menuItemId: string): Promise<void> {\n    const verb = VerbId.RemoveExternalMenuItem;\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'removeContextMenuAsync',\n      [ParameterId.WorksheetName]: sheetName,\n      [ParameterId.ExternalMenuItemId]: menuItemId,\n    };\n\n    return this.execute(verb, parameters).then<void>((response) => {\n      return;\n    });\n  }\n\n  public executeContextMenuAsync(sheetName: string, targetMenu: ApiMenuType, menuItemId: string): Promise<void> {\n    const verb = VerbId.ExecuteExternalMenuItem;\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'executeContextMenuAsync',\n      [ParameterId.WorksheetName]: sheetName,\n      [ParameterId.ExternalMenuItemId]: menuItemId,\n    };\n\n    return this.execute(verb, parameters).then<void>((response) => {\n      return;\n    });\n  }\n\n  public renameContextMenuAsync(sheetName: string, targetMenu: ApiMenuType, menuHeader: string, menuDescription: string): Promise<void> {\n    const verb = VerbId.RenameExternalMenu;\n    const parameters: ExecuteParameters = {\n      [ParameterId.FunctionName]: 'renameContextMenuAsync',\n      [ParameterId.WorksheetName]: sheetName,\n      [ParameterId.ExternalMenuHeader]: menuHeader,\n      [ParameterId.ExternalMenuDescription]: menuDescription,\n    };\n\n    return this.execute(verb, parameters).then<void>((response) => {\n      return;\n    });\n  }\n}\n"]}