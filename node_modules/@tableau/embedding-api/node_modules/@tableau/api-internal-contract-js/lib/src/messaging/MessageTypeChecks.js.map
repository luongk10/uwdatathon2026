{"version":3,"file":"MessageTypeChecks.js","sourceRoot":"","sources":["../../../src/messaging/MessageTypeChecks.ts"],"names":[],"mappings":";;AAAA,6BAA6B;AAC7B,6DAA2D;AAE3D,2DAQkC;AAElC,MAAM,0BAA0B,GAAG,IAAI,GAAG,CAAC;IACzC,8BAAc,CAAC,iBAAiB;IAChC,8BAAc,CAAC,0BAA0B;IACzC,8BAAc,CAAC,iBAAiB;IAChC,8BAAc,CAAC,oBAAoB;IACnC,8BAAc,CAAC,uBAAuB;CACvC,CAAC,CAAC;AAEH,2BAA2B;AAC3B,SAAgB,SAAS,CAAC,IAAmB;IAC3C,IAAI,CAAC,IAAI,EAAE;QACT,OAAO,KAAK,CAAC;KACd;IAED,MAAM,OAAO,GAAG,IAAe,CAAC;IAChC,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;QACpD,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACjC,OAAO,KAAK,CAAC;KACd;IAED,IAAI,OAAO,OAAO,CAAC,OAAO,KAAK,QAAQ,EAAE;QACvC,OAAO,KAAK,CAAC;KACd;IAED,MAAM,YAAY,GAAkB;QAClC,0BAAW,CAAC,OAAO;QACnB,0BAAW,CAAC,eAAe;QAC3B,0BAAW,CAAC,UAAU;QACtB,0BAAW,CAAC,YAAY;QACxB,0BAAW,CAAC,SAAS;KACtB,CAAC;IAEF,IAAI,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;QAC7C,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AA/BD,8BA+BC;AAED,SAAgB,SAAS,CAAC,aAAkC;IAC1D,IAAI,CAAC,aAAa,EAAE;QAClB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,CAAC,GAAG,aAA8B,CAAC;IAEzC,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;QACzB,OAAO,KAAK,CAAC;KACd;IAED,IAAI,OAAO,CAAC,CAAC,GAAG,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,QAAQ,EAAE;QAC3F,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAhBD,8BAgBC;AAED,SAAgB,aAAa,CAAC,OAAgC;IAC5D,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;QACvB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,WAAW,GAAG,OAA4B,CAAC;IACjD,IAAI,WAAW,CAAC,OAAO,KAAK,0BAAW,CAAC,UAAU,EAAE;QAClD,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,WAAW,CAAC,UAAU,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,EAAE;QACjE,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,WAAW,CAAC,iBAAiB,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,iBAAiB,CAAC,EAAE;QAC/E,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAnBD,sCAmBC;AAED,SAAgB,wBAAwB,CAAC,OAAqC;IAC5E,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;QACvB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,SAAS,GAAG,OAAiC,CAAC;IACpD,IAAI,SAAS,CAAC,OAAO,KAAK,0BAAW,CAAC,eAAe,EAAE;QACrD,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE;QACvC,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;QACvC,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAnBD,4DAmBC;AAED,SAAgB,gBAAgB,CAAC,OAA6B;IAC5D,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;QACvB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,cAAc,GAAG,OAAyB,CAAC;IACjD,IAAI,cAAc,CAAC,OAAO,KAAK,0BAAW,CAAC,OAAO,EAAE;QAClD,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,cAAc,CAAC,UAAU,IAAI,OAAO,cAAc,CAAC,UAAU,KAAK,QAAQ,EAAE;QAC/E,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,cAAc,CAAC,MAAM,IAAI,OAAO,cAAc,CAAC,MAAM,KAAK,QAAQ,EAAE;QACvE,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAnBD,4CAmBC;AAED,SAAgB,qBAAqB,CAAC,OAAkC;IACtE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;QACvB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,mBAAmB,GAAG,OAA8B,CAAC;IAC3D,IAAI,mBAAmB,CAAC,OAAO,KAAK,0BAAW,CAAC,YAAY,EAAE;QAC5D,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,mBAAmB,CAAC,IAAI,IAAI,CAAC,0BAA0B,CAAC,GAAG,CAAC,mBAAmB,CAAC,cAAc,CAAC,EAAE;QACpG,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,mBAAmB,CAAC,cAAc,IAAI,OAAO,mBAAmB,CAAC,cAAc,KAAK,QAAQ,EAAE;QACjG,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAnBD,sDAmBC;AAED,SAAgB,kBAAkB,CAAC,OAA+B;IAChE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;QACvB,OAAO,KAAK,CAAC;KACd;IAED,MAAM,gBAAgB,GAAG,OAA2B,CAAC;IACrD,IAAI,gBAAgB,CAAC,OAAO,KAAK,0BAAW,CAAC,SAAS,EAAE;QACtD,OAAO,KAAK,CAAC;KACd;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAXD,gDAWC","sourcesContent":["import * as guid from 'guid';\nimport { NotificationId } from '../contract/Notifications';\nimport { VersionNumber } from '../interface/VersionNumber';\nimport {\n  CommandMessage,\n  CommandResponseMessage,\n  HandshakeMessage,\n  InitializeMessage,\n  Message,\n  MessageType,\n  NotificationMessage,\n} from './interface/MessageTypes';\n\nconst expectedEmptyNotifications = new Set([\n  NotificationId.EditButtonClicked,\n  NotificationId.EditInDesktopButtonClicked,\n  NotificationId.WorkbookPublished,\n  NotificationId.WorkbookReadyToClose,\n  NotificationId.ReadyToReceiveAuthToken,\n]);\n\n/* tslint:disable no-any */\nexport function isMessage(data: Message | any): data is Message {\n  if (!data) {\n    return false;\n  }\n\n  const message = data as Message;\n  if (!message || !message.msgGuid || !message.msgType) {\n    return false;\n  }\n\n  if (!guid.isGuid(message.msgGuid)) {\n    return false;\n  }\n\n  if (typeof message.msgType !== 'string') {\n    return false;\n  }\n\n  const messageTypes: Array<string> = [\n    MessageType.Command,\n    MessageType.CommandResponse,\n    MessageType.Initialize,\n    MessageType.Notification,\n    MessageType.Handshake,\n  ];\n\n  if (messageTypes.indexOf(message.msgType) < 0) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isVersion(versionNumber: VersionNumber | any): versionNumber is VersionNumber {\n  if (!versionNumber) {\n    return false;\n  }\n\n  const v = versionNumber as VersionNumber;\n\n  if (typeof v !== 'object') {\n    return false;\n  }\n\n  if (typeof v.fix !== 'number' || typeof v.minor !== 'number' || typeof v.major !== 'number') {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isInitMessage(message: InitializeMessage | any): message is InitializeMessage {\n  if (!isMessage(message)) {\n    return false;\n  }\n\n  const initMessage = message as InitializeMessage;\n  if (initMessage.msgType !== MessageType.Initialize) {\n    return false;\n  }\n\n  if (!initMessage.apiVersion || !isVersion(initMessage.apiVersion)) {\n    return false;\n  }\n\n  if (!initMessage.crossFrameVersion || !isVersion(initMessage.crossFrameVersion)) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isCommandResponseMessage(message: CommandResponseMessage | any): message is CommandResponseMessage {\n  if (!isMessage(message)) {\n    return false;\n  }\n\n  const crMessage = message as CommandResponseMessage;\n  if (crMessage.msgType !== MessageType.CommandResponse) {\n    return false;\n  }\n\n  if (!guid.isGuid(crMessage.commandGuid)) {\n    return false;\n  }\n\n  if (!crMessage.data && !crMessage.error) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isCommandMessage(message: CommandMessage | any): message is CommandMessage {\n  if (!isMessage(message)) {\n    return false;\n  }\n\n  const commandMessage = message as CommandMessage;\n  if (commandMessage.msgType !== MessageType.Command) {\n    return false;\n  }\n\n  if (!commandMessage.parameters || typeof commandMessage.parameters !== 'object') {\n    return false;\n  }\n\n  if (!commandMessage.verbId || typeof commandMessage.verbId !== 'string') {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isNotificationMessage(message: NotificationMessage | any): message is NotificationMessage {\n  if (!isMessage(message)) {\n    return false;\n  }\n\n  const notificationMessage = message as NotificationMessage;\n  if (notificationMessage.msgType !== MessageType.Notification) {\n    return false;\n  }\n\n  if (!notificationMessage.data && !expectedEmptyNotifications.has(notificationMessage.notificationId)) {\n    return false;\n  }\n\n  if (!notificationMessage.notificationId || typeof notificationMessage.notificationId !== 'string') {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isHandshakeMessage(message: HandshakeMessage | any): message is HandshakeMessage {\n  if (!isMessage(message)) {\n    return false;\n  }\n\n  const handshakeMessage = message as HandshakeMessage;\n  if (handshakeMessage.msgType !== MessageType.Handshake) {\n    return false;\n  }\n\n  return true;\n}\n"]}